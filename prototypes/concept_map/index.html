<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tell It Your Way - The Concept Map</title>
    
    <style>
        /* --- General Reset & Page Centering --- */
        body { 
            margin: 0; 
            background-color: #1a1a1a; /* Dark background for the area outside the frame */
            overflow: hidden; 
            font-family: sans-serif;
            color: #ccc;
            /* Flexbox to center the entire game on the screen */
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        button {
            cursor: pointer;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            transition: background-color 0.2s;
            font-size: 1em;
        }
        button:hover {
            background-color: #0056b3;
        }
        
        #intro-screen {
            aspect-ratio: 4 / 3; 
    
    /* Maximize size within the viewport */
    max-width: 95vw;
    max-height: 95vh;
    width: auto; 
    height: 100%;
    position: fixed;
    
    /* 1. BACKGROUND IMAGE FIXES */
    background-image: url('backgrounds/room_00.jpg'); /* <-- ADD YOUR IMAGE PATH HERE */
    background-repeat: no-repeat; /* Prevents the image from tiling */
    background-size: cover;       /* Ensures the image fills the screen */
    background-position: center;  /* Centers the image */
    
    /* 2. ALIGNMENT FIXES */
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* Aligns content to the top */
    align-items: flex-start;   /* Aligns content to the left */
    
    /* 3. PADDING/OFFSET */
    padding-top: 20vh; /* Push content down 5% from the top edge */
    padding-left: 5vw; /* Push content right 5% from the left edge */
    box-sizing: border-box; /* Ensures padding is included in the 100% height/width */
    
    background-color: #111;
    z-index: 200;
}

/* You might need to adjust the heading to remove default margins that affect spacing */
#intro-screen h1 {
    margin-bottom: 5px; /* Keep this for spacing below the title */
    color: white;
    font-size: 50px;
}
#intro-screen h2 {
    margin-bottom: 20px; /* Keep this for spacing below the title */
    color: white;
    font-size: 20px;
}

#intro-screen button {
            margin: 10px;
            padding: 15px 30px;
            font-size: 1.2em;
        }

        /* --- Game Container (The 4:3 Scaling Canvas) --- */
        /* --- Game Container (The 4:3 Scaling Canvas) --- */
#game-container {
    /* Adaptive Scaling: Game will always be 4:3 */
    aspect-ratio: 4 / 3; 
    
    /* Maximize size within the viewport */
    max-width: 95vw;
    max-height: 95vh;
    
    /* üí• CRITICAL FIX: Add a starting point for width */
    width: auto; 
    height: 100%; /* Let aspect-ratio and width determine the height */
    
    /* Crucial for percentage positioning of children */
    position: relative; 
    overflow: hidden;
    
    /* Starts hidden */
    display: none; 
}
        /* --- Rooms (Full 100% of the game container) --- */
        .room {
            width: 100%;
            height: 100%;
            position: absolute;
            background-size: cover;
            background-position: center;
        }
        
        /* Room Backgrounds: Use local path for your files */
        #room-1 { 
            background-image: url('backgrounds/room_01.jpg');
            background-color: #4CAF50; /* Fallback color for testing */
        }
        #room-2 { 
            background-image: url('backgrounds/room_02.jpg');
            background-color: #999999; /* Fallback color for testing */
        }
        #room-3 { 
            background-image: url('backgrounds/room_03.jpg');
            background-color: #008800; /* Fallback */
        }
        #room-3b { 
            background-image: url('backgrounds/room_03b.jpg');
            background-color: #008800; /* Fallback */
        }
        #room-3c { 
            background-image: url('backgrounds/room_03b.jpg');
            background-color: #008800; /* Fallback */
        }
        #room-4 { 
            background-image: url('backgrounds/room_04.jpg');
            background-color: #000088; /* Fallback */
        }
        #room-5 { 
            background-image: url('backgrounds/room_05.jpg');
            background-color: #008800; /* Fallback */
        }
        #room-6 { 
            background-image: url('backgrounds/room_06.jpg');
            background-color: #000088; /* Fallback */
        }#room-7 { 
            background-image: url('backgrounds/room_07.jpg');
            background-color: #008800; /* Fallback */
        }
        #room-8 { 
            background-image: url('backgrounds/room_08.jpg');
            background-color: #000088; /* Fallback */
        }#room-9 { 
            background-image: url('backgrounds/room_09.jpg');
            background-color: #008800; /* Fallback */
        }
        #room-10 { 
            background-image: url('backgrounds/room_10.jpg');
            background-color: #000088; /* Fallback */
        }

        /* --- Bottom HUD Bar (Fixed to the Bottom using Percentage) --- */
        #bottom-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%; 
            height: 10%; /* 10% of the 4:3 container height */
            color: white;
        
            display: flex;
            justify-content: space-between; 
            align-items: center;
            padding: 0 3%; 
            margin-bottom: 20px;
            box-sizing: border-box;
            z-index: 20;
        }

        #section-title-display {
            /* Actual displayed title in each scene */
            font-size: clamp(12px, 1.8vw, 24px); 
            font-weight: bold;
            color: gold;
            width: 50%;
            text-shadow: 1px 1px 3px #000;
            padding-top: 1%;
            padding-left: 1%;
        }

        #nav-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end; /* Align buttons to the right */
            width: 60%; 
        }

        #nav-buttons button {
            background-color: #1abc9c;
            color: white;
            padding: 0.8em 1.5em;
            font-size: clamp(10px, 1.2vw, 18px); /* Scaling font size */
        }


        /* --- Interactable Elements (Positioning uses PERCENTAGE) --- */
        /* --- Interactable Elements (Cleaned for Image Display) --- */
/* --- Interactable Elements (Positioning uses PERCENTAGE) --- */
.interactable {
    position: absolute;
    cursor: pointer;
    
    border-radius: 10px;
    box-sizing: border-box;
    color: white;
    text-align: center;
    z-index: 5;
    
    /* üí• ADDED: Smooth transition for scale and shadow */
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; 
}

/* ---------------------------------------------------- */
/* --- NEW HOVER RULES --- */
/* ---------------------------------------------------- */

/* 1. Slight Expansion (on the parent container) */
.interactable:hover {
    /* Expands the item slightly (e.g., 5% larger) */
    /*transform: scale(1.05);*/ 
    z-index: 10; /* Ensure the hovered item is on top of others */
}

/* 2. Backlit Glow (on the inner image) */
.interactable:hover .interactable-image {
    /* Applies a glow filter that respects PNG transparency */
    filter: drop-shadow(0 0 10px gold) drop-shadow(0 0 5px white);
    /* Syntax: drop-shadow(x-offset y-offset blur-radius color) */
}

/* --- Scene Link Hover Glow (Unique Style) --- */
.interactable.scene:hover .interactable-image {
    /* Uses a vibrant green glow for navigation/scene changers */
    filter: drop-shadow(0 0 10px #1abc9c) drop-shadow(0 0 5px #7fffd4);
}
/* Optional: Use a specific class for the dashed border if needed for other items */
.interactable.dashed-border {
    border: 3px dashed yellow;
    background-color: rgba(255, 255, 0, 0.2);
}
        
        .interactable-image {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
        }

        /* Room 1 Item and Character (Positions are relative to the 100% room size) */
       /* #item-1a {
             
            left: 33%;  
            top: 20%;   
            width: 16%; 
            height: 24%;
            
        }*/
        /* #char-1b { 
           
            left: 15%;
            top: 28%; 
            width: 12%; 
            height: 32%; 
            border-color: orange; 
        }*/

        /* --- Navigation Arrows --- */
        .nav-arrow {
            position: absolute;
            width: 4%;
            height: 20%;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.6); 
            color: white;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
        }
        .left-arrow { left: 0; border-radius: 0 10px 10px 0; }
        .right-arrow { right: 0; border-radius: 10px 0 0 10px; }

        /* --- Overlays (Modals) --- */
        /* Overlay styles are unchanged and remain fixed to the viewport (not scaled) */
        /* --- Overlays (Modals) --- */
.overlay {
    display: none; 
    position: fixed; 
    z-index: 200;
    left: 0; top: 0; width: 100%; height: 100%;
    /*background-color: rgba(0,0,0,0.95);*/
    backdrop-filter: blur(5px);
    
    /* CRITICAL FIX: Add centering to the full-screen container */
    justify-content: center; 
    align-items: center;
}
       /* --- Overlays (Modals) --- */
/* The parent .overlay remains unchanged */

/* --- Overlay Content (The Inner Box) --- */
.overlay-content {
    background-color: #fefefe;
    margin: 0; /* Remove auto margins, centering is handled by the parent .overlay */
    padding: 30px;
    border-radius: 8px;
    
    /* üí• CRITICAL: New Sizing */
    width: 90vw; /* Take 90% of viewport width */
    height: 90vh; /* Take 90% of viewport height */
    max-width: none; /* Ignore old max-width */
    
    /* Layout for Centering Content */
    display: flex;
    flex-direction: column; /* Content is managed in a column */
    justify-content: center; /* Vertically center content */
    align-items: center; /* Horizontally center content */

    position: relative;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    color: #333;
    box-sizing: border-box; /* Include padding/border in the 90vw/90vh total */
}

/* --- Info Overlay Elements (Sizing for Centering) --- */
#info-overlay .overlay-content #info-image {
    /* Image takes maximum space but maintains aspect ratio */
    width: 100%; 
    height: 100%;
    
    /* Image is centered within the full overlay */
    background-size: contain; 
    background-repeat: no-repeat;
    background-position: center; 
    
    /* Ensures the image content container is visible */
    display: flex;
    justify-content: center;
    align-items: center;
    
    margin: 0; /* Remove old side margins */
    aspect-ratio: auto; /* Allow image to fill space naturally */
}

#info-overlay .overlay-content #info-text {
    /* Text container takes maximum space for large content */
    width: 80%; 
    max-width: 1000px;
    
    /* Ensure text is readable and centered */
    font-size: clamp(1em, 2vw, 2.5em);
    line-height: 1.4em;
    text-align: center;
    overflow-y: auto; /* Allows scrolling for long text */
}
        .close-btn { 
            position: absolute; top: 10px; right: 10px; 
            background-color: #dc3545; padding: 5px 10px; border-radius: 50%; 
        }
       /* --- Dialogue Box Structure (UPDATED) --- */
/* --- Dialogue Overlay Structure (Visual Novel Style) --- */

/* --- Dialogue Overlay Structure (Visual Novel Style) --- */

/* Dialogue Box (The 3:4 Visual Scene) */
        #dialogue-overlay .dialogue-box {
            position: relative; /* Crucial for positioning the text box inside */
            margin: 0;
            
            /* CRITICAL: Enforce the 3:4 aspect ratio */
            aspect-ratio: 4/3;
            height: 100vh; /* Base the width on viewport height for stability */
            max-width: 90vw;
            max-height: 90vh;
            
            /* Character Image as Background */
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat;
            
            padding: 0; 
            border-radius: 10px;
            background-color: transparent;
            
            /* We are relying on JS (showOverlay) to set the dialogue-overlay parent to display: flex */
            /* DO NOT set display: flex here */
        }

        /* Dialogue Content (The Text Box) */
        #dialogue-content {
            /* Position the text box at the very bottom */
            position: absolute; 
            bottom: 0;
            left: 0;
            width: 100%; 
            
            background-color: rgba(0, 0, 0, 0.7); 
            color: white;
            padding: 20px 30px;
            box-sizing: border-box;
            
            /* Text layout within the box */
            display: flex;
            flex-direction: column;
        }

        #dialogue-content p {
            margin: 0;
            font-size: 1.1em;
            min-height: 40px; 
        }

        #dialogue-overlay .next-btn {
            align-self: flex-end; /* Push button to the right */
            background-color: #1abc9c;
            margin-top: 10px;
        }

        #map-overlay .map-grid button {
            display: inline-block; margin: 5px; width: 150px; background-color: #1abc9c;
        }
        /* --- MAP GALLERY STYLES (Retained/Refined) --- */
#map-gallery {
    display: flex;
    flex-wrap: wrap; 
    gap: 20px;
    justify-content: center;
    padding: 20px 0;
    width: 100%;
    margin-top: 15px;
}

.map-thumbnail {
    /* Use a fixed width relative to the overlay size */
    width: 20%; 
    min-width: 200px;
    padding: 0;
    margin: 0;
    
    position: relative; 
    border: 3px solid #1abc9c;
    overflow: hidden;
    background: none;
    transition: transform 0.2s, box-shadow 0.2s;
}

.map-thumbnail:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5); /* Stronger shadow on hover */
}

.map-thumbnail.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* 16:9 Aspect Ratio Container (unchanged) */
.thumbnail-image {
    aspect-ratio: 16 / 9;
    width: 100%;
    background-size: cover;
    background-position: center;
    background-color: #555;
}

/* --- TITLE OVERLAY (The Hover Effect) --- */
.thumbnail-title {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%; /* Title covers the entire thumbnail area */
    
    /* Center the text vertically and horizontally */
    display: flex;
    align-items: center;
    justify-content: center;
    
    /* Initial State: Hidden and Transparent */
    opacity: 0; 
    background-color: rgba(0, 0, 0, 0.85); /* Semi-transparent black overlay */
    color: white;
    font-weight: bold;
    font-size: 1em; /* Larger text when it appears */
    
    /* Smooth transition for fade-in/out */
    transition: opacity 0.3s ease; 
}

/* Hover State: When the parent is hovered, make the title visible */
.map-thumbnail:hover .thumbnail-title {
    opacity: 1; /* Fade in completely */
}
/* Thumbnails need to pull the same images as the rooms */
.thumbnail-image[data-room-id="room-1"] {
    /* NOTE: You should use your 'backgrounds/room_01.png' here too! */
    background-image: url('backgrounds/thumbnails/thumbnail_01.jpg'); 
}
.thumbnail-image[data-room-id="room-2"] {
    background-image: url('backgrounds/thumbnails/thumbnail_02.jpg');
}
.thumbnail-image[data-room-id="room-3"] {
    background-image: url('backgrounds/thumbnails/thumbnail_03.jpg');
}
.thumbnail-image[data-room-id="room-4"] {
    background-image: url('backgrounds/thumbnails/thumbnail_04.jpg');
}
.thumbnail-image[data-room-id="room-5"] {
    background-image: url('backgrounds/thumbnails/thumbnail_05.jpg');
}
.thumbnail-image[data-room-id="room-6"] {
    background-image: url('backgrounds/thumbnails/thumbnail_06.jpg');
}
.thumbnail-image[data-room-id="room-7"] {
    background-image: url('backgrounds/thumbnails/thumbnail_07.jpg');
}
.thumbnail-image[data-room-id="room-8"] {
    background-image: url('backgrounds/thumbnails/thumbnail_08.jpg');
}
.thumbnail-image[data-room-id="room-9"] {
    background-image: url('backgrounds/thumbnails/thumbnail_09.jpg');
}
.thumbnail-image[data-room-id="room-10"] {
    background-image: url('backgrounds/thumbnails/thumbnail_10.jpg');
}
    </style>
</head>
<body>

    <div id="intro-screen">

        <h1>Tell It Your Way</h1>
        <h2>Engaging Community in Preserving Vietnamese<br>Folktales with Narrative Web-based Game</h2>
        <button id="start-btn">Start Tour</button>
        <button onclick="showOverlay('instructions-overlay')">Instructions & Help</button>
        <button onclick="showOverlay('map-overlay')">Museum Map (Quick Travel)</button>
    </div>

    <div id="game-container" style="display: none;"> 
        
        <div class="room" id="room-1">
            <h2 class="room-title" style="display: none;">Background & Context</h2>
           
            <div class="interactable item" id="item-1b" style="left: 63%; top: 47%; width: 7%; height: 13%;">
                <div class="interactable-image" style="background-image: url('items/item_1B.png');"></div>
            </div>
            <div class="interactable item" id="item-1c" style="left: 72%; top: 47%; width: 7%; height: 13%;">
                <div class="interactable-image" style="background-image: url('items/item_1C.png');"></div>
            </div>
            <div class="interactable item" id="item-1d" style="left: 63%; top: 61%; width: 7%; height: 13%;">
                <div class="interactable-image" style="background-image: url('items/item_1D.png');"></div>
            </div>
            <div class="interactable item" id="item-1e" style="left: 72%; top: 61%; width: 7%; height: 13%;">
                <div class="interactable-image" style="background-image: url('items/item_1E.png');"></div>
            </div>
            <div class="interactable character" id="char-1b" style="left: 24%; top: 28%; width: 12%; height: 26%">
                <div class="interactable-image" style="background-image: url('characters/char_1B.png');"></div>
            </div>
            
            <div class="interactable link" id="external-link-1" style="left: 56%; top: 20%; width: 27%; height: 20%;">
                <div class="interactable-image" style="background-image: url('items/item_1F.png');"></div>
            </div>
            <div class="nav-arrow right-arrow" data-target="room-2">NEXT ></div>
        </div>

        <div class="room" id="room-2" style="display: none;">
            <h2 class="room-title" style="display: none;">Role of Design & Objectives</h2>
            <div class="interactable item" id="item-2a" style="left: 25%; top: 18%; width: 51%; height: 28%;"">
                <div class="interactable-image" style="background-image: url('items/item_2A.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-1">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-3">NEXT ></div>
        </div>


        <div class="room" id="room-3" style="display: none;">
            <h2 class="room-title" style="display: none;">Research Questions</h2>
            <div class="interactable scene" id="link-to-room-3" style="left: 5%; top: 20%; width: 15%; height: 20%;">
                <div class="interactable-image" style="background-image: url('placeholders/doorway.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-2">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-3b">NEXT ></div>
        </div>
        <div class="room" id="room-3b" style="display: none;">
            <h2 class="room-title" style="display: none;">Research Questions</h2>
            <div class="interactable item" id="item-3a" style="left: 23%; top: 23%; width: 54%; height: 40%;"">
                <div class="interactable-image" style="background-image: url('items/item_3A.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-3">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-4">NEXT ></div>
        </div>
         <div class="room" id="room-3c" style="display: none;">
            <h2 class="room-title" style="display: none;">Research Questions</h2>
            <div class="interactable item" id="item-3b" style="left: 23%; top: 23%; width: 54%; height: 40%;"">
                <div class="interactable-image" style="background-image: url('items/item_3B.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-3b">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-4">NEXT ></div>
        </div>
        <div class="room" id="room-4" style="display: none;">
            <h2 class="room-title" style="display: none;"> Design Framework & Methodologies</h2>
            <div class="interactable item" id="item-4a" style="left: 29%; top: 19%; width: 13%; height:27%;"">
                <div class="interactable-image" style="background-image: url('items/item_4A.png');"></div>
            </div>
            <div class="interactable item" id="item-4b" style="left: 44%; top: 19%; width: 13%; height:27%;"">
                <div class="interactable-image" style="background-image: url('items/item_4B.png');"></div>
            </div>
            <div class="interactable item" id="item-4c" style="left: 59%; top: 19%; width: 13%; height:27%;"">
                <div class="interactable-image" style="background-image: url('items/item_4C.png');"></div>
            </div>
            <div class="interactable item" id="item-4d" style="left: 3%; top: 31%; width: 13%; height:36%;"">
                <div class="interactable-image" style="background-image: url('items/item_4D.png');"></div>
            </div>
            <div class="interactable item" id="item-4e" style="left: 83%; top: 31%; width: 13%; height:36%;"">
                <div class="interactable-image" style="background-image: url('items/item_4E.png');"></div>
            </div>
            <div class="interactable item" id="item-4f" style="left: 33%; top: 52%; width: 34%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_4F.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-3">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-5">NEXT ></div>
        </div>
        <div class="room" id="room-5" style="display: none;">
            <h2 class="room-title" style="display: none;">Exercises Archive</h2>
            <div class="interactable item" id="item-5a" style="left: 4%; top: 51%; width: 13%; height:18%;"">
                <div class="interactable-image" style="background-image: url('items/item_5A.png');"></div>
            </div>
            <div class="interactable item" id="item-5b" style="left: 18%; top: 20%; width: 32%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_5B.png');"></div>
            </div>
            <div class="interactable item" id="item-5c" style="left: 22%; top: 37%; width: 22%; height:39%;"">
                <div class="interactable-image" style="background-image: url('items/item_5C.png');"></div>
            </div>
            <div class="interactable item" id="item-5d" style="left: 52%; top: 18%; width: 19%; height:17%;"">
                <div class="interactable-image" style="background-image: url('items/item_5D.png');"></div>
            </div>
            <div class="interactable item" id="item-5e" style="left: 53%; top: 36%; width: 19%; height:17%;"">
                <div class="interactable-image" style="background-image: url('items/item_5E.png');"></div>
            </div>
            <div class="interactable item" id="item-5f" style="left: 73%; top: 20%; width: 10%; height:26%;"">
                <div class="interactable-image" style="background-image: url('items/item_5F.png');"></div>
            </div>
            <div class="interactable item" id="item-5g" style="left: 80%; top: 47%; width: 13%; height:18%;"">
                <div class="interactable-image" style="background-image: url('items/item_5G.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-4">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-6">NEXT ></div>
        </div>
        <div class="room" id="room-6" style="display: none;">
            <h2 class="room-title" style="display: none;">Audience & Stakeholders</h2>
            <div class="interactable character" id="item-6a" style="left: 23%; top: 36%; width: 10%; height: 43%">
                <div class="interactable-image" style="background-image: url('characters/char_6A.png');"></div>
            </div>
            <div class="interactable character" id="char-6b" style="left: 45%; top: 36%; width: 10%; height: 43%">
                <div class="interactable-image" style="background-image: url('characters/char_6B.png');"></div>
            </div>
            <div class="interactable character" id="char-6c" style="left: 67%; top: 36%; width: 10%; height: 43%">
                <div class="interactable-image" style="background-image: url('characters/char_6C.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-5">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-7">NEXT ></div>
        </div>
        <div class="room" id="room-7" style="display: none;">
            <h2 class="room-title" style="display: none;">My Findings</h2>
            <div class="interactable item" id="item-7a" style="left: 16%; top: 24%; width: 28%; height:12%;"">
                <div class="interactable-image" style="background-image: url('items/item_7A.png');"></div>
            </div>
            <div class="interactable item" id="item-7b" style="left: 16%; top: 39%; width: 28%; height:20%;"">
                <div class="interactable-image" style="background-image: url('items/item_7B.png');"></div>
            </div>
            <div class="interactable item" id="item-7c" style="left: 16%; top: 60%; width: 28%; height:12%;"">
                <div class="interactable-image" style="background-image: url('items/item_7C.png');"></div>
            </div>
            <div class="interactable item" id="item-7d" style="left: 56%; top: 19%; width: 28%; height:28%;"">
                <div class="interactable-image" style="background-image: url('items/item_7D.png');"></div>
            </div>
           
            
            <div class="nav-arrow left-arrow" data-target="room-6">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-8">NEXT ></div>
        </div>
        <div class="room" id="room-8" style="display: none;">
            <h2 class="room-title" style="display: none;">Case Studies</h2>
            <div class="interactable item" id="item-8a" style="left: 18%; top: 19%; width: 20%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_8A.png');"></div>
            </div>
            <div class="interactable item" id="item-8b" style="left: 40%; top: 19%; width: 20%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_8B.png');"></div>
            </div>
            <div class="interactable item" id="item-8c" style="left: 63%; top: 19%; width: 20%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_8C.png');"></div>
            </div>
            <div class="interactable item" id="item-8d" style="left: 18%; top: 34%; width: 20%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_8D.png');"></div>
            </div>
            <div class="interactable item" id="item-8e" style="left: 40%; top: 34%; width: 20%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_8E.png');"></div>
            </div>
            <div class="interactable item" id="item-8f" style="left: 63%; top: 34%; width: 20%; height:13%;"">
                <div class="interactable-image" style="background-image: url('items/item_8F.png');"></div>
            </div>
            
            <div class="nav-arrow left-arrow" data-target="room-7">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-9">NEXT ></div>
        </div>
        <div class="room" id="room-9" style="display: none;">
            <h2 class="room-title" style="display: none;">Design Briefs & Prototypes</h2>
            <div class="interactable item" id="item-9a" style="left: 13%; top: 44%; width: 41%; height:14%;"">
                <div class="interactable-image" style="background-image: url('items/item_9A.png');"></div>
            </div>
            <div class="interactable item" id="item-9b" style="left: 13%; top: 57%; width: 41%; height:14%;"">
                <div class="interactable-image" style="background-image: url('items/item_9B.png');"></div>
            </div>
            <div class="interactable item" id="item-9c" style="left: 72%; top: 42%; width: 14%; height:18%;"">
                <div class="interactable-image" style="background-image: url('items/item_9C.png');"></div>
            </div>
            <div class="interactable item" id="item-9d" style="left: 86%; top: 18%; width: 10%; height:27%;"">
                <div class="interactable-image" style="background-image: url('items/item_9D.png');"></div>
            </div>
            <div class="interactable item" id="item-9e" style="left: 40%; top: 17%; width: 20%; height:18%;"">
                <div class="interactable-image" style="background-image: url('items/item_9E.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-8">< PREV</div>
            <div class="nav-arrow right-arrow" data-target="room-10">NEXT ></div>
        </div>
        <div class="room" id="room-10" style="display: none;">
            <h2 class="room-title" style="display: none;">Future Framing</h2>
            <div class="interactable item" id="item-10a" style="left: 7%; top: 22%; width: 41%; height:45%;"">
                <div class="interactable-image" style="background-image: url('items/item_10A.png');"></div>
            </div>
            <div class="nav-arrow left-arrow" data-target="room-9">< PREV</div>
            </div>
        <div id="bottom-bar">
            <div id="section-title-display"></div>
            <div id="nav-buttons">
                <button onclick="goHome()">Home</button> 
                <button onclick="showOverlay('map-overlay')">Map</button>
                <button onclick="showOverlay('instructions-overlay')">Help</button>
            </div>

        </div>

    </div>
    
    <div id="info-overlay" class="overlay">
        <div class="overlay-content">
            <button class="close-btn" onclick="closeOverlay('info-overlay')">X</button>
            <div id="info-image"></div>
            <div id="info-text"></div>
        </div>
    </div>
<div id="dialogue-overlay" class="overlay">
    <div class="dialogue-box">
        <div id="dialogue-content"> 
            <p id="dialogue-text"></p>
            <button class="next-btn" onclick="nextDialogue()">Continue...</button>
        </div>
    </div>
</div>
    <div id="instructions-overlay" class="overlay">
        <div class="overlay-content">
            <button class="close-btn" onclick="closeOverlay('instructions-overlay')">X</button>
            <h2>How to Tour the Museum</h2>
            <p><strong>Movement:</strong> Use the **PREV/NEXT** arrows on the sides of the room.</p>
            <p><strong>Item Interaction:</strong> Click on **dashed objects** (Items) to see research content overlays.</p>
            <p><strong>Controls:</strong> Use the **buttons in the bottom frame** for navigation and help.</p>
        </div>
    </div>
    <div id="map-overlay" class="overlay">
    <div class="overlay-content">
        <button class="close-btn" onclick="closeOverlay('map-overlay')">X</button>
        <h2>Museum Map - Quick Travel</h2>
        <p>Click a section to jump directly to that part of the research.</p>
        
        <div id="map-gallery">
            <button class="map-thumbnail" onclick="quickTravel('room-1')">
                <div class="thumbnail-image" data-room-id="room-1"></div>
                <div class="thumbnail-title">Background</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-2')">
                <div class="thumbnail-image" data-room-id="room-2"></div>
                <div class="thumbnail-title">Role of Design & Objectives</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-3')">
                <div class="thumbnail-image" data-room-id="room-3"></div>
                <div class="thumbnail-title">Research Questions</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-4')">
                <div class="thumbnail-image" data-room-id="room-4"></div>
                <div class="thumbnail-title">Design Framework & Methodologies</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-5')">
                <div class="thumbnail-image" data-room-id="room-5"></div>
                <div class="thumbnail-title">Areas of Research & Theoretical Framework</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-6')">
                <div class="thumbnail-image" data-room-id="room-6"></div>
                <div class="thumbnail-title">Audience & Stakeholders</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-7')">
                <div class="thumbnail-image" data-room-id="room-7"></div>
                <div class="thumbnail-title">My Findings</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-8')">
                <div class="thumbnail-image" data-room-id="room-8"></div>
                <div class="thumbnail-title">Case Studies</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-9')">
                <div class="thumbnail-image" data-room-id="room-9"></div>
                <div class="thumbnail-title">Design Briefs & Prototypes</div>
            </button>
            <button class="map-thumbnail" onclick="quickTravel('room-10')">
                <div class="thumbnail-image" data-room-id="room-10"></div>
                <div class="thumbnail-title">Future Framing</div>
            </button>
        </div>
        </div>
</div>

    <script>
        // --- Data Structure (Content for all interactables) ---
        const museumData = {
            'item-1a': {
                type: 'item',
                title: 'Topic Breakdown Diagram',
                // CRITICAL: Update this path for the overlay image
                imagePath: 'items/item_1A.png', 
                text: ''},
            'item-1b': {
                type: 'item',
                title: 'Heritage Magazine Issue #4 - Storytelling For Cultural Survival!',
                // CRITICAL: Update this path for the overlay image
                text: 'Storytelling plays an important role in forming the social foundation of culture, a living practice  through which communities build identity, share empathy, and transmit wisdom across generations.<br>So, when storytelling becomes detached from its practice, where stories are recorded but no longer retold, the living practice cease to exist.'},
            'item-1c': {
                type: 'item',
                title: 'Vietnam Family Cultural Beat 2025',
                // CRITICAL: Update this path for the overlay image
                text: 'In the Vietnamese family home, storytelling has always been a staple activity between family members, where memories are encoded into stories and shared intergenerationally.<br>However, as Vietnam rapidly modernises, family structures are changing to adapt in the modern context.<br>This changes how storytelling can be practiced in the family space and often decreased altogether.'
            },
            'item-1d': {
                type: 'item',
                title: 'Digital Media Today!',
                // CRITICAL: Update this path for the overlay image
                text: 'In Vietnam, as in many countries, rapid technological advancement has spurred national efforts to digitize cultural heritage. These initiatives often treat intangible cultural heritage  as static data, overlooking its performative and participatory essence.<br>Meanwhile, global shifts in media habits show that audiences increasingly favour interactive, user-generated forms of content creation, activities that mirror the improvisational spirit of traditional storytelling.'
            },
            'item-1e': {
                type: 'item',
                title: 'Gamer Insider Issue #17',
                // CRITICAL: Update this path for the overlay image
                text: 'By channelling this participatory potential toward cultural expression, game-based systems offer a powerful avenue for sustaining storytelling as a living practice. Games invite players to perform, interpret, and collaborate, creating shared meaning through play.<br>This research will explore how play can facilitate communal sense-making, enabling ordinary participants to engage in the creative and reflective practice of storytelling.'
            },
            'char-1b': {
                type: 'character',
                // ADDED: Path to the character's portrait for the dialogue box
                dialogue: [
                    "Ah, a new visitor! Welcome to the reception wing.","My name is Han, I'll be your guide for this exhibition. So if you have any questions please feel free to ask me.","The physical version of me, I mean."
                ]
            },
            'item-2a': {
                type: 'item',
                title: 'Role of Design',
                imagePath: 'items/item_2A.png',
                text: ''},

            'link-to-room-3': {
                //light turn off
                type: 'scene',
                destinationId: 'room-3b' // Define the room it links to
            },
            'item-3a': {
                //transition to scene 3c
                type: 'scene',
                destinationId: 'room-3c' // Define the room it links to
            },
            'external-link-1': {
                type: 'link',
                //url: 'https://www.google.com/' // Replace with your actual external link
                internalPath: '../../exercises/context_mapping.jpeg'
            },
            'item-4a': {
                type: 'item',
                //url: 'https://www.google.com/' // Replace with your actual external link
                imagePath:'../../exercises/design_framework/exploration.jpg',
               // internalPath: '../../exercises/design_framework/exploration.pdf'
            },
            'item-4b': {
                type: 'item',
                //url: 'https://www.google.com/' // Replace with your actual external link
                imagePath: '../../exercises/design_framework/design.jpg'
            },
            'item-4c': {
                type: 'item',
                //url: 'https://www.google.com/' // Replace with your actual external link
                imagePath: '../../exercises/design_framework/evaluation.jpg'
            },
            'item-4d': {
                type: 'item',
                //url: 'https://www.google.com/' // Replace with your actual external link
                imagePath: '../../exercises/design_framework/primary.jpg'
            },
            'item-4e': {
                type: 'item',
                //url: 'https://www.google.com/' // Replace with your actual external link
                imagePath: '../../exercises/design_framework/secondary.jpg'
            },
            'item-4f': {
                type: 'item',
                title: 'Approach',
                //url: 'https://www.google.com/' // Replace with your actual external link
                text: 'The project follows a Research-through-Design (RtD) (Frayling) approach informed by Human-Centered Design (HCD) (Norman) and Design Thinking principles (IDEO Design Thinking).<br>The process iterates through Exploration, Design, and Evaluation, each cycle informed by reflection (Sch√∂n).'
            },
            'item-5a': {
                type: 'link',
                //Micro Macro Missing
                internalPath: '../../exercises/design_framework/secondary.pdf'
            },
            'item-5b': {
                type: 'link',
                //MMM
                internalPath: '../../exercises/LyDuKhanhHan_MicroMesoMacroAnalysis_V02.pdf'
            },
            'item-5c': {
                type: 'link',
                //glossary 
                internalPath: '../../exercises/glossary.html'
            },
            'item-5d': {
                type: 'link',
                //Empathy Map
                internalPath: '../../exercises/empathy_map.pdf'
            },
            'item-5e': {
                type: 'link',
                //User Journey
                internalPath: '../../exercises/empathy_map.pdf'
            },
            'item-5f': {
                type: 'link',
                //Crazy 8
                internalPath: '../../exercises/design_framework/secondary.pdf'
            },
            'item-5g': {
                type: 'item',
                title: 'Haiku',
                //url: 'https://www.google.com/' // Replace with your actual external link
                text: 'Stories stuck in book<br>But made into games online<br>All can join and play'
            },
            'item-6a': {
                type: 'link',
                //User Journey
                internalPath: '../../exercises/profile.html'
            },
            'char-6b': {
                type: 'character',
                // ADDED: Path to the character's portrait for the dialogue box
                dialogue: [
                    "This painting reminds me of my childhood home...","I wish I could tell my grandchildren all the stories about the peaceful life we had there. And the games we used to play!","But they visit me so rarely, and they're so shy around me..."
                ]
            },
            'char-6c': {
                type: 'character',
                // ADDED: Path to the character's portrait for the dialogue box
                dialogue: [
                    "I'm examining our visitor's responses of the display today, but they hardly do anything interesting to note.","We want them to engage more than just looking. But I'm struggling to find out how we can do that!","Any ideas?"
                ]
            },
            'item-7a': {
                type: 'link',
                //Literature review
                internalPath: '../../literature/index.html'
            },
            'item-7b': {
                type: 'link',
                //Field work
                internalPath: '../../fieldwork/index.html'
            },
            'item-7c': {
                type: 'link',
                //Prototype
                internalPath: '../../prototypes/mala_quiz/proto_mala_quiz.html'
            },
            'item-10a': {
                type: 'item',
                title: 'Conclusion',
                imagePath: 'items/item_10A.png',
                text: ''},
            
            
    };

        // --- Game State Variables (Unchanged) ---
        let currentDialogue = [];
        let dialogueIndex = 0;

        // --- CORE FUNCTION: Scene Transition (Unchanged) ---
        function goToRoom(roomId) {
            document.querySelectorAll('.room').forEach(room => {
                room.style.display = 'none';
            });
            const targetRoom = document.getElementById(roomId);
            if (targetRoom) {
                targetRoom.style.display = 'block';
            }

            // Update the bottom display text for the new room
            const roomTitleElement = targetRoom.querySelector('.room-title');
            if (roomTitleElement) {
                document.getElementById('section-title-display').innerText = roomTitleElement.innerText;
            }
        }

        // --- CORE FUNCTION: Overlay Control (Unchanged) ---
        function closeOverlay(id) {
            document.getElementById(id).style.display = 'none';
        }

        function showOverlay(id) {
            document.getElementById(id).style.display = 'flex';
        }

        // --- HELPER FUNCTION: Launches the game container and travels to room ---
        function launchGameContainer(roomId) {
            const gameContainer = document.getElementById('game-container');
            const introScreen = document.getElementById('intro-screen');

            // CRITICAL FIX: Ensure the game container is visible before navigation.
            if (gameContainer.style.display === 'none' || introScreen.style.display !== 'none') {
                introScreen.style.display = 'none';
                gameContainer.style.display = 'block';
            }
            
            goToRoom(roomId);
        }

        // --- NEW FUNCTION: Go Home ---
        function goHome() {
            document.getElementById('game-container').style.display = 'none';
            document.getElementById('intro-screen').style.display = 'flex';
            closeOverlay('map-overlay');
        }

        // --- GAME START (Uses new helper) ---
        function startGame() {
            launchGameContainer('room-1'); 
        }

        // --- QUICK TRAVEL (Uses new helper and closes map) ---
        function quickTravel(roomId) {
            launchGameContainer(roomId);
            closeOverlay('map-overlay');
        }

        // --- Item/Info Handler (Unchanged) ---
        // --- Item/Info Handler (UPDATED FOR EXCLUSIVE CONTENT) ---
        function openItemInfo(itemId) {
            const data = museumData[itemId];
            if (data.type !== 'item') return;

            const imageDiv = document.getElementById('info-image');
            const textDiv = document.getElementById('info-text');

            // 1. Reset/Hide Both Containers
            imageDiv.style.display = 'none';
            textDiv.style.display = 'none';

            const hasImage = data.imagePath && data.imagePath.length > 0;
            const hasText = data.text && data.text.length > 0;

            if (hasImage) {
                // Show only the Image
                imageDiv.style.backgroundImage = `url('${data.imagePath}')`; 
                imageDiv.style.display = 'flex'; // Use flex to center the background image (as set in CSS)
            } else if (hasText) {
                // Show only the Text
                textDiv.innerHTML = `<h3>${data.title}</h3><p>${data.text}</p>`;
                textDiv.style.display = 'block';
            } else {
                // Fallback if item has neither
                textDiv.innerHTML = `<h3>No Content Available</h3><p>This exhibit is currently empty.</p>`;
                textDiv.style.display = 'block';
            }

            showOverlay('info-overlay');
        }

        // --- Character/Dialogue Handler (UPDATED FOR PORTRAIT) ---
        // --- Character/Dialogue Handler (UPDATED FOR VISUAL NOVEL STYLE) ---
        function openCharacterDialogue(itemId) {
            const data = museumData[itemId];
            if (data.type !== 'character') return;
            
            // 1. Set the dialogue state
            currentDialogue = data.dialogue;
            dialogueIndex = 0;
            
            // 2. Set the character image as the background of the dialogue box
            const dialogueBox = document.querySelector('#dialogue-overlay .dialogue-box');
            if (data.portraitPath) {
                 // CRITICAL: The portraitPath now holds the full character scene image
                dialogueBox.style.backgroundImage = `url('${data.portraitPath}')`;
            } else {
                dialogueBox.style.backgroundImage = 'none'; // Clear if no image is available
            }
            
            // 3. Set the initial text
            document.getElementById('dialogue-text').innerText = currentDialogue[dialogueIndex];
            
            // 4. Show the overlay
            showOverlay('dialogue-overlay');
        }
        function nextDialogue() {
            dialogueIndex++;
            if (dialogueIndex < currentDialogue.length) {
                document.getElementById('dialogue-text').innerText = currentDialogue[dialogueIndex];
            } else {
                closeOverlay('dialogue-overlay');
            }
        }

        // --- Initialization & Global Event Listener (UPDATED for External Links) ---
        document.addEventListener('DOMContentLoaded', () => {
            const startButton = document.getElementById('start-btn');
            if (startButton) {
                startButton.addEventListener('click', startGame);
            }

            document.addEventListener('click', (event) => {
                const target = event.target;

                // 1. Handle Navigation Arrows
                if (target.classList.contains('nav-arrow')) {
                    const targetRoomId = target.getAttribute('data-target');
                    goToRoom(targetRoomId);
                    return;
                }

                // 2. Use .closest() to find the parent .interactable
                const interactableElement = target.closest('.interactable'); 
                
                if (interactableElement) {
                    const itemId = interactableElement.id; 
                    const data = museumData[itemId];
                    const type = data ? data.type : null;

                    if (type === 'item') {
                        openItemInfo(itemId);
                    } else if (type === 'character') {
                        openCharacterDialogue(itemId);
                    } else if (type === 'scene') {
                        if (data.destinationId) {
                            goToRoom(data.destinationId);
                        }
                    } else if (type === 'link') { // üí• NEW LOGIC: Open external link
                        if (data.url) {
                            // Opens the URL in a new browser tab/window
                            window.open(data.url, '_blank'); 
                        }
                        else if (data.internalPath) {
                        
                        window.open(data.internalPath, '_blank'); 
                    } 
                    }
                }
            });
        });
    </script>
</body>
</html>